---
import RevCounter from "./RevCounter.astro";
import { Image } from "astro:assets";
// Orijinal JPG'yi kullan - Astro Sharp otomatik AVIF'e çevirecek ve responsive boyutlar oluşturacak
import heroImageJpg from "/src/assets/images/hyundai-servis.jpg";
---

<section
  class="relative h-screen min-h-[600px] flex items-center overflow-hidden bg-slate-900"
  style="min-height: 100vh; contain: layout;"
>
  <!-- Cinematic Background Image with Parallax Feel -->
  <div class="absolute inset-0 z-0 overflow-hidden">
    <div class="absolute inset-0 bg-slate-900/20 z-10"></div>
    <!-- Extra dim for text contrast -->
    <Image
      id="hero-bg"
      src={heroImageJpg}
      alt="Tetik Oto Servis"
      class="w-full h-[120%] top-0 absolute object-cover object-top parallax-img will-change-transform"
      width={1920}
      height={1080}
      format="avif"
      quality={40}
      loading="eager"
      fetchpriority="high"
      sizes="100vw"
      widths={[640, 1024, 1280, 1920]}
    />
    <!-- Premium Gradient Overlay -->
    <div
      class="absolute inset-0 bg-gradient-to-r from-slate-950 via-slate-900/80 to-transparent z-20"
    >
    </div>
    <div
      class="absolute inset-0 bg-gradient-to-t from-slate-950 via-transparent to-transparent z-20"
    >
    </div>
  </div>

  <!-- Grid Pattern Texture (Subtle Tech Feel) -->
  <div
    class="absolute inset-0 z-0 opacity-[0.03]"
    style="background-image: radial-gradient(#fff 1px, transparent 1px); background-size: 30px 30px;"
  >
  </div>

  <!-- Content Container -->
  <div class="container relative z-30 mx-auto px-4 md:px-6">
    <div class="grid lg:grid-cols-12 gap-4 items-center pt-8">
      <!-- Left Column: Content (Wider 9/12) -->
      <div class="lg:col-span-9">
        <!-- Main Headline - Fluid Typography with clamp() -->
        <h1
          class="text-5xl md:text-6xl font-bold text-white leading-tight tracking-tight mb-8 drop-shadow-2xl font-heading hero-title"
        >
          TOYOTA <span class="text-red-600">&</span> NISSAN <br />
          HYUNDAI <span class="text-orange-500">&</span> KIA <br />
          <span
            class="text-transparent bg-clip-text bg-gradient-to-r from-slate-200 to-white"
            >ÖZEL SERVİS</span
          >
        </h1>

        <!-- Description -->
        <p
          class="text-lg md:text-xl text-slate-300 mb-10 max-w-2xl leading-relaxed font-light animate-fade-up delay-100 font-sans"
        >
          17 yıllık tecrübe, orijinal yedek parça ve garantili işçilik ile
          aracınız emin ellerde. Gebze ve bölgesinin en kapsamlı özel servisi.
        </p>

        <!-- Action Buttons -->
        <div class="flex flex-col sm:flex-row gap-4 animate-fade-up delay-200">
          <a
            href="tel:05336157835"
            class="group relative px-8 py-4 bg-orange-700 hover:bg-orange-800 text-white font-bold rounded-xl transition-all duration-300 shadow-[0_0_20px_rgba(234,88,12,0.3)] hover:shadow-[0_0_30px_rgba(234,88,12,0.5)] hover:-translate-y-1 flex items-center justify-center gap-3 overflow-hidden font-sans"
          >
            <span class="relative z-10">Hemen Ara</span>
            <svg
              class="w-5 h-5 relative z-10 group-hover:rotate-12 transition-transform"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              ><path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"
              ></path></svg
            >
            <!-- Shine Effect -->
            <div
              class="absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 bg-gradient-to-r from-transparent via-white/20 to-transparent skew-x-12"
            >
            </div>
          </a>

          <a
            href="/iletisim"
            class="px-8 py-4 bg-white/5 hover:bg-white/10 text-white font-bold rounded-xl border border-white/10 hover:border-white/30 backdrop-blur-sm transition-all duration-300 flex items-center justify-center gap-3 font-sans"
          >
            <span>Ücretsiz Muayene</span>
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              ><path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 5l7 7-7 7"></path></svg
            >
          </a>
        </div>
      </div>

      <!-- Right Column: Visual Stats (Slide In) (Narrower 3/12) -->
      <div
        class="hidden lg:block relative lg:col-span-3 justify-self-end w-full"
      >
        <!-- Decorative Elements -->
        <div
          class="absolute -top-20 -right-20 text-[10rem] font-black text-white opacity-[0.03] select-none font-heading leading-none pointer-events-none"
        >
          TETİK
        </div>

        <div
          class="animate-fade-left delay-300 relative bg-slate-800/50 backdrop-blur-xl p-8 rounded-3xl border-l-4 border-orange-500 shadow-2xl max-w-[320px] ml-auto transform transition-all hover:scale-[1.02] duration-500"
        >
          <div class="grid grid-cols-1 gap-8">
            <div
              class="flex items-center justify-between border-b border-white/5 pb-4 last:border-0 last:pb-0"
            >
              <div>
                <div
                  class="text-4xl font-bold text-white mb-1 font-heading group-hover:text-orange-500 transition-colors flex"
                >
                  <span class="counter" data-target="17">0</span><span>+</span>
                </div>
                <div
                  class="text-[10px] text-slate-400 font-bold font-sans tracking-widest uppercase"
                >
                  Yıllık Tecrübe
                </div>
              </div>
              <div class="text-right">
                <div
                  class="text-4xl font-bold text-white mb-1 font-heading group-hover:text-orange-500 transition-colors flex justify-end"
                >
                  <span>%</span><span class="counter" data-target="100">0</span>
                </div>
                <div
                  class="text-[10px] text-slate-400 font-bold font-sans tracking-widest uppercase"
                >
                  Müşteri Memnuniyeti
                </div>
              </div>
            </div>

            <div class="flex items-center justify-between">
              <div>
                <div
                  class="text-4xl font-bold text-white mb-1 font-heading group-hover:text-orange-500 transition-colors flex"
                >
                  <span class="counter" data-target="12">0</span>
                </div>
                <div
                  class="text-[10px] text-slate-400 font-bold font-sans tracking-widest uppercase"
                >
                  Ay Garanti
                </div>
              </div>
              <div class="text-right">
                <div
                  class="text-4xl font-bold text-white mb-1 font-heading group-hover:text-orange-500 transition-colors flex justify-end"
                >
                  <span class="counter" data-target="7">0</span><span>/</span
                  ><span class="counter" data-target="24">0</span>
                </div>
                <div
                  class="text-[10px] text-slate-400 font-bold font-sans tracking-widest uppercase"
                >
                  Destek Hattı
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Absolute Decorative Elements -->
  <div
    class="absolute bottom-0 right-0 w-1/3 h-full bg-gradient-to-l from-orange-600/10 to-transparent pointer-events-none z-20"
  >
  </div>
  <div
    class="absolute -bottom-20 -right-20 w-96 h-96 bg-blue-600/20 rounded-full blur-[120px] pointer-events-none z-20"
  >
  </div>
</section>

<style>
  /* Fluid Typography - Responsive Hero Title */
  .hero-title {
    font-size: clamp(3rem, 5vw, 5rem);
  }

  @media (min-width: 1024px) {
    .hero-title {
      font-size: clamp(4.5rem, 5vw, 6.5rem);
    }
  }

  @media (min-width: 1536px) {
    .hero-title {
      font-size: clamp(5rem, 4.5vw, 7rem);
    }
  }

  /* Simple CSS Animations for Performance */
  @keyframes fade-up {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes fade-left {
    from {
      opacity: 0;
      transform: translateX(50px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  .animate-fade-up {
    animation: fade-up 0.6s cubic-bezier(0.2, 1, 0.3, 1) forwards;
    opacity: 0; /* Start invisible */
  }

  .animate-fade-left {
    animation: fade-left 1s cubic-bezier(0.2, 1, 0.3, 1) forwards;
    opacity: 0; /* Start invisible */
  }

  .delay-100 {
    animation-delay: 0.15s;
  }
  .delay-200 {
    animation-delay: 0.3s;
  }
  .delay-300 {
    animation-delay: 0.45s;
  }
  .delay-400 {
    animation-delay: 0.6s;
  }
</style>

<script>
  // Simple & Performance Friendly Parallax Effect
  const heroBg = document.getElementById("hero-bg");

  if (heroBg) {
    window.addEventListener(
      "scroll",
      () => {
        const scrollPosition = window.scrollY;
        // Limit calculation to only when hero is visible for performance
        if (scrollPosition < 1000) {
          const yPos = -scrollPosition * 0.2; // Negative value moves image up, preventing top gap
          // We use transform translate3d for GPU acceleration
          heroBg.style.transform = `translate3d(0, ${yPos}px, 0) scale(1.05)`;
        }
      },
      { passive: true },
    );
  }

  // Number Counter Animation
  const counters = document.querySelectorAll<HTMLElement>(".counter");
  const speed = 200; // The lower the slower

  const animateCounters = () => {
    counters.forEach((counter) => {
      const updateCount = () => {
        const target = +(counter.getAttribute("data-target") || "0");
        const count = +counter.innerText;
        const inc = target / speed;

        if (count < target) {
          counter.innerText = String(Math.ceil(count + inc));
          setTimeout(updateCount, 20);
        } else {
          counter.innerText = String(target);
        }
      };
      updateCount();
    });
  };

  // Trigger animation when element is in view
  const observerOptions = {
    threshold: 0.5,
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        animateCounters();
        observer.unobserve(entry.target);
      }
    });
  }, observerOptions);

  const statsContainer = document.querySelector(".animate-fade-left");
  if (statsContainer) {
    observer.observe(statsContainer);
  }
</script>
